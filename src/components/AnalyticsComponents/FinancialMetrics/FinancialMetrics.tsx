import React from 'react'
import styled from '@emotion/styled'
import { useTheme } from '@itsrever/design-system'
import { formatPrice } from '../../../utils'
import { ReportsReportResponse } from '@itsrever/dashboard-api'

interface FinancialMetricsProps {
    report: ReportsReportResponse | undefined
}
const FinancialMetrics: React.FC<FinancialMetricsProps> = ({ report }) => {
    const theme = useTheme()

    const moneyFormat = report?.money_format
    const grossSales =
        moneyFormat && formatPrice(report?.gross_sales || 0, moneyFormat)
    const discounts =
        moneyFormat && formatPrice(report?.discounts || 0, moneyFormat)
    const returnsToOpm =
        moneyFormat && formatPrice(report?.returns || 0, moneyFormat)

    const netSales =
        moneyFormat &&
        formatPrice(
            (report?.gross_sales || 0) +
                (report?.discounts || 0) +
                (report?.returns || 0),
            moneyFormat
        )

    const shipping =
        moneyFormat && formatPrice(report?.shipping || 0, moneyFormat)
    const taxes = moneyFormat && formatPrice(report?.taxes || 0, moneyFormat)
    const returnsByRever =
        moneyFormat &&
        formatPrice(
            (report?.rever_returns || 0) + (report?.rever_opm || 0),
            moneyFormat
        )
    const totalNetSales =
        moneyFormat &&
        formatPrice(
            (report?.gross_sales || 0) +
                (report?.discounts || 0) +
                (report?.returns || 0) +
                (report?.shipping || 0) +
                (report?.taxes || 0) +
                (report?.rever_returns || 0) +
                (report?.rever_opm || 0),
            moneyFormat
        )
    const reverSales =
        moneyFormat && formatPrice(report?.rever_net_sales || 0, moneyFormat)
    return (
        <MainDiv borderColor={theme.colors.grey[3]}>
            <GridDiv2>
                <h5>
                    <b>Concept</b>
                </h5>
                <h5 className="text-end">
                    <b>Value</b>
                </h5>
                <h5>
                    <b>Description</b>
                </h5>

                <p>Gross sales</p>
                <p className="text-end">{grossSales}</p>
                <p className="text-grey-2">Gross sales from Shopify</p>

                <p>Discounts</p>
                <p className="text-end">{discounts}</p>
                <p className="text-grey-2">Discounts applied from Shopify</p>

                <p>Refunds to original payment method</p>
                <p className="text-end">{returnsToOpm}</p>
                <p className="text-grey-2 ">
                    Gross returns from Shopify coming from original payment
                    method, manual refunds or cancellations
                </p>
                <hr className="col-span-3 m-0" />
                <h5>
                    <b>Net sales</b>
                </h5>
                <p className="text-end">
                    <b>{netSales}</b>
                </p>
                <p className="text-grey-2 ">Net sales from Shopify</p>

                <p>Shipping costs</p>
                <p className="text-end">{shipping}</p>
                <p className="text-grey-2 ">Shipping costs from Shopify</p>

                <p>Taxes</p>
                <p className="text-end">{taxes}</p>
                <p className="text-grey-2 ">Total taxes from Shopify</p>

                <p>Returns by REVER</p>
                <p className="text-primary-dark text-end">{returnsByRever}</p>
                <p className="text-grey-2 ">
                    Total returns by REVER - Bank transfers, promo codes, gift
                    cards and exchanges.
                </p>
                <hr className="col-span-3" />
                <h5>
                    <b>Total Net sales</b>
                </h5>
                <p className="text-end">
                    <b>{totalNetSales}</b>
                </p>
                <p className="text-grey-2 ">The total of Net sales</p>
                <p>Coming from REVER</p>
                <p className="text-primary-dark text-end">{reverSales}</p>
                <p className="text-grey-2">
                    Part of total net sales generated by Exchanges, Promo codes
                    or Gift cards from REVER
                </p>
            </GridDiv2>
        </MainDiv>
    )
}

export default FinancialMetrics

interface BoxProps {
    borderColor: string
}

const GridDiv2 = styled.div`
    display: grid;
    grid-template-columns: 1.5fr 1fr 3fr;
    grid-template-rows: repeat(10, minmax(0, 1fr));
    gap: 5px 40px;
    grid-template-areas:
        '. . .'
        '. . .'
        '. . .'
        '. . .'
        '. . .'
        '. . .'
        '. . .'
        '. . .'
        '. . .'
        '. . .';
    width: 100%;
`

const MainDiv = styled.div<BoxProps>`
    border-radius: 0.5rem;
    border: 1px solid;
    border-color: ${(p) => p.borderColor};
    padding: 1.5rem;
    background-color: #fff;
    width: 100%;
`

const GridDiv = styled.div`
    display: grid;
    grid-template-columns: repeat(4, minmax(0, 1fr));
    gap: 0.5rem;
    align-items: center;
    width: fit-content;
`
